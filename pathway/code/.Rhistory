cluster_cols = F,
color = colorRampPalette(c("white", '#D53389',"#6D0C68"))(100),
main = "")
p
ggsave(paste0(save_path,save_name,'_1group1row.png'),p,width=12,height=20,dpi=300,limitsize = FALSE)
ggsave(paste0(save_path,save_name,'_1group1row.png'),p,width=14,height=20,dpi=300,limitsize = FALSE)
# Sankey
library(networkD3)
library(htmlwidgets)
node_colors_dict=c(
'motor'='#ed6d46',
'cognition'='#2e59a7',
'gds'='#fedc5e','stai'='#fac03d',
'scopa'='#DBC1AA',
'rem'='#cc5756','ess'='#EBB2B5')
# Prepare data for plot
target <- rep(rownames(plot_df), times = ncol(plot_df))#trait
source <- rep(colnames(plot_df), each = nrow(plot_df))#group
value <- as.vector(as.matrix(plot_df))
filtered_source <- source[source %in% all_traits]
filtered_target <- target[source %in% all_traits]
filtered_value <- value[source %in% all_traits]
nodes <- data.frame(name = unique(c(filtered_source, filtered_target)))
left_nodes <- nodes %>% filter(name %in% all_traits)
right_nodes <- nodes %>% filter(!(name %in% all_traits))
nodes <- bind_rows(left_nodes, right_nodes)
# Create a data frame for links
links <- data.frame(
source = match(filtered_source, nodes$name) - 1,
target = match(filtered_target, nodes$name) - 1,
value = filtered_value
)
node_colors <- sapply(nodes$name, function(name) {
if (name %in% names(node_colors_dict)) {
node_colors_dict[name]
} else {
"#f9cbe1"
}
})
names(node_colors) <- nodes$name
node_colors <- paste0("d3.scaleOrdinal().domain(['", paste(nodes$name, collapse="', '"), "']).range(['", paste(node_colors, collapse="', '"), "'])")
# Create a data frame for links
links <- data.frame(
source = match(filtered_source, nodes$name) - 1,
target = match(filtered_target, nodes$name) - 1,
value = filtered_value
)
# set connection colors
links$group <- as.factor(links$source)
nodes$group <- as.factor(nodes$name)
domain=paste0('[', paste(sQuote(nodes$name, q = FALSE), collapse = ','), ']')
colors=as.vector(node_colors_dict[nodes$name])
range=paste0('[', paste(sQuote(colors, q = FALSE), collapse = ','), ']')
my_color <- paste('d3.scaleOrdinal()',
'.domain(',domain,')',
'.range(',range,')')
#plot
p <- sankeyNetwork(Links = links, Nodes = nodes,
Source = "source", Target = "target",
Value = "value", NodeID = "name",
colourScale=node_colors,LinkGroup="group", NodeGroup="group",
sinksRight=FALSE, fontSize = 20,iterations = 0)
p
saveWidget(p, file=paste0(save_path,save_name,'_sankey',".html"))
plot_matrix
plot_df_norm=plot_df/max(plot_df)
plot_df_norm
max(plot_df)
plot_df
plot_df_norm=plot_matrix/max(plot_matrix)
plot_df_norm
node_colors_dict=c(
'motor'='#ed6d46',
'cognition'='#2e59a7',
'gds'='#fedc5e','stai'='#fac03d',
'scopa'='#DBC1AA',
'rem'='#cc5756','ess'='#EBB2B5')
plot_df_norm=plot_matrix/max(plot_matrix)
plot_sankey=function(plot_df,all_traits,node_colors_dict,save_path,save_name){
# Prepare data for plot
target <- rep(rownames(plot_df), times = ncol(plot_df))#trait
source <- rep(colnames(plot_df), each = nrow(plot_df))#group
value <- as.vector(as.matrix(plot_df))
filtered_source <- source[source %in% all_traits]
filtered_target <- target[source %in% all_traits]
filtered_value <- value[source %in% all_traits]
nodes <- data.frame(name = unique(c(filtered_source, filtered_target)))
left_nodes <- nodes %>% filter(name %in% all_traits)
right_nodes <- nodes %>% filter(!(name %in% all_traits))
nodes <- bind_rows(left_nodes, right_nodes)
# Create a data frame for links
links <- data.frame(
source = match(filtered_source, nodes$name) - 1,
target = match(filtered_target, nodes$name) - 1,
value = filtered_value
)
node_colors <- sapply(nodes$name, function(name) {
if (name %in% names(node_colors_dict)) {
node_colors_dict[name]
} else {
"grey90"
}
})
names(node_colors) <- nodes$name
node_colors <- paste0("d3.scaleOrdinal().domain(['", paste(nodes$name, collapse="', '"), "']).range(['", paste(node_colors, collapse="', '"), "'])")
# Create a data frame for links
links <- data.frame(
source = match(filtered_source, nodes$name) - 1,
target = match(filtered_target, nodes$name) - 1,
value = filtered_value
)
# set connection colors
links$group <- as.factor(links$source)
nodes$group <- as.factor(nodes$name)
domain=paste0('[', paste(sQuote(nodes$name, q = FALSE), collapse = ','), ']')
colors=as.vector(node_colors_dict[nodes$name])
range=paste0('[', paste(sQuote(colors, q = FALSE), collapse = ','), ']')
my_color <- paste('d3.scaleOrdinal()',
'.domain(',domain,')',
'.range(',range,')')
#plot
p <- sankeyNetwork(Links = links, Nodes = nodes,
Source = "source", Target = "target",
Value = "value", NodeID = "name",
colourScale=node_colors,LinkGroup="group", NodeGroup="group",
sinksRight=FALSE, fontSize = 20,iterations = 0)
saveWidget(p, file=paste0(save_path,save_name,'_sankey',".html"))
}
plot_sankey(plot_df_norm,all_traits,node_colors_dict,save_path,save_name)
all_traits
plot_sankey=function(plot_df,all_traits,node_colors_dict,save_path,save_name){
# Prepare data for plot
target <- rep(rownames(plot_df), times = ncol(plot_df))#trait
source <- rep(colnames(plot_df), each = nrow(plot_df))#group
value <- as.vector(as.matrix(plot_df))
filtered_source <- source[source %in% all_traits]
filtered_target <- target[source %in% all_traits]
filtered_value <- value[source %in% all_traits]
nodes <- data.frame(name = unique(c(filtered_source, filtered_target)))
left_nodes <- nodes %>% filter(name %in% all_traits)
right_nodes <- nodes %>% filter(!(name %in% all_traits))
nodes <- bind_rows(left_nodes, right_nodes)
# Create a data frame for links
links <- data.frame(
source = match(filtered_source, nodes$name) - 1,
target = match(filtered_target, nodes$name) - 1,
value = filtered_value
)
node_colors <- sapply(nodes$name, function(name) {
if (name %in% names(node_colors_dict)) {
node_colors_dict[name]
} else {
"#f9cbe1"
}
})
names(node_colors) <- nodes$name
node_colors <- paste0("d3.scaleOrdinal().domain(['", paste(nodes$name, collapse="', '"), "']).range(['", paste(node_colors, collapse="', '"), "'])")
# Create a data frame for links
links <- data.frame(
source = match(filtered_source, nodes$name) - 1,
target = match(filtered_target, nodes$name) - 1,
value = filtered_value
)
# set connection colors
links$group <- as.factor(links$source)
nodes$group <- as.factor(nodes$name)
domain=paste0('[', paste(sQuote(nodes$name, q = FALSE), collapse = ','), ']')
colors=as.vector(node_colors_dict[nodes$name])
range=paste0('[', paste(sQuote(colors, q = FALSE), collapse = ','), ']')
my_color <- paste('d3.scaleOrdinal()',
'.domain(',domain,')',
'.range(',range,')')
#plot
p <- sankeyNetwork(Links = links, Nodes = nodes,
Source = "source", Target = "target",
Value = "value", NodeID = "name",
colourScale=node_colors,LinkGroup="group", NodeGroup="group",
sinksRight=FALSE, fontSize = 20,iterations = 0)
saveWidget(p, file=paste0(save_path,save_name,'_sankey',".html"))
}
plot_sankey(plot_df_norm,all_traits,node_colors_dict,save_path,save_name)
plot_sankey=function(plot_df,all_traits,node_colors_dict,save_path,save_name){
# Prepare data for plot
target <- rep(rownames(plot_df), times = ncol(plot_df))#trait
source <- rep(colnames(plot_df), each = nrow(plot_df))#group
value <- as.vector(as.matrix(plot_df))
filtered_source <- source[source %in% all_traits]
filtered_target <- target[source %in% all_traits]
filtered_value <- value[source %in% all_traits]
nodes <- data.frame(name = unique(c(filtered_source, filtered_target)))
left_nodes <- nodes %>% filter(name %in% all_traits)
right_nodes <- nodes %>% filter(!(name %in% all_traits))
nodes <- bind_rows(left_nodes, right_nodes)
# Create a data frame for links
links <- data.frame(
source = match(filtered_source, nodes$name) - 1,
target = match(filtered_target, nodes$name) - 1,
value = filtered_value
)
node_colors <- sapply(nodes$name, function(name) {
if (name %in% names(node_colors_dict)) {
node_colors_dict[name]
} else {
"#e5e5e5"
}
})
names(node_colors) <- nodes$name
node_colors <- paste0("d3.scaleOrdinal().domain(['", paste(nodes$name, collapse="', '"), "']).range(['", paste(node_colors, collapse="', '"), "'])")
# Create a data frame for links
links <- data.frame(
source = match(filtered_source, nodes$name) - 1,
target = match(filtered_target, nodes$name) - 1,
value = filtered_value
)
# set connection colors
links$group <- as.factor(links$source)
nodes$group <- as.factor(nodes$name)
domain=paste0('[', paste(sQuote(nodes$name, q = FALSE), collapse = ','), ']')
colors=as.vector(node_colors_dict[nodes$name])
range=paste0('[', paste(sQuote(colors, q = FALSE), collapse = ','), ']')
my_color <- paste('d3.scaleOrdinal()',
'.domain(',domain,')',
'.range(',range,')')
#plot
p <- sankeyNetwork(Links = links, Nodes = nodes,
Source = "source", Target = "target",
Value = "value", NodeID = "name",
colourScale=node_colors,LinkGroup="group", NodeGroup="group",
sinksRight=FALSE, fontSize = 20,iterations = 0)
saveWidget(p, file=paste0(save_path,save_name,'_sankey',".html"))
}
plot_sankey(plot_df_norm,all_traits,node_colors_dict,save_path,save_name)
plot_matrix
write.csv(plot_matrix,paste0(save_path,save_name,'_1group1row.csv'))
## REAC
database='REAC'
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/',database,'/')
save_name='REAC_heatmap_refined'
heatmap_df_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/heatmap_pathway_top20_go.csv'
order_pathway_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/refine_order_pathway_v2.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_dir,heatmap_save_path,heatmap_traits,database)
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_dir,heatmap_df_file,heatmap_traits,database)
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,heatmap_save_path,heatmap_traits,database)
system(cmd)
# ---- Collect heatmap data for each database----
heatmap_traits='motor,cognition,gds,stai,scopa,ess,rem'
## GO
database='GO'
pathway_result_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/',database,'/')
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/',database,'/')
if (!dir.exists(heatmap_save_path)) {
dir.create(heatmap_save_path, recursive = TRUE)
}
cmd=paste('Rscript get_heatmap_table.R',pathway_result_path,heatmap_save_path,heatmap_traits,database)
system(cmd)
## REAC
database='REAC'
pathway_result_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/',database,'/')
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/',database,'/')
if (!dir.exists(heatmap_save_path)) {
dir.create(heatmap_save_path, recursive = TRUE)
}
cmd=paste('Rscript get_heatmap_table.R',pathway_result_path,heatmap_save_path,heatmap_traits,database)
system(cmd)
## KEGG
database='KEGG'
pathway_result_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/',database,'/')
heatmap_df_dir=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/',database,'/')
if (!dir.exists(heatmap_save_path)) {
dir.create(heatmap_save_path, recursive = TRUE)
}
cmd=paste('Rscript get_heatmap_table.R',pathway_result_path,heatmap_save_path,heatmap_traits,database)
system(cmd)
# ----  Plot refined heatmap ----
## GO
database='GO'
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/',database,'/')
save_name='GO_heatmap_refined'
heatmap_df_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/GO/heatmap_pathway_top20_go.csv'
order_pathway_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/GO/refine_order_pathway_v4.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,heatmap_save_path,heatmap_traits,database)
system(cmd)
## REAC
database='REAC'
## REAC
database='REAC'
pathway_result_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/',database,'/')
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/',database,'/')
if (!dir.exists(heatmap_save_path)) {
dir.create(heatmap_save_path, recursive = TRUE)
}
cmd=paste('Rscript get_heatmap_table.R',pathway_result_path,heatmap_save_path,heatmap_traits,database)
system(cmd)
## KEGG
database='KEGG'
pathway_result_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/',database,'/')
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/',database,'/')
if (!dir.exists(heatmap_save_path)) {
dir.create(heatmap_save_path, recursive = TRUE)
}
cmd=paste('Rscript get_heatmap_table.R',pathway_result_path,heatmap_save_path,heatmap_traits,database)
system(cmd)
# ----  Plot refined heatmap ----
## GO
database='GO'
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/',database,'/')
save_name='GO_heatmap_refined'
heatmap_df_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/GO/heatmap_pathway_top20_go.csv'
order_pathway_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/GO/refine_order_pathway_v4.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,heatmap_save_path,heatmap_traits,database)
system(cmd)
# ----  Plot refined heatmap ----
## GO
database='GO'
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/',database,'/')
save_name='GO_heatmap_refined'
heatmap_df_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/GO/heatmap_pathway_top20_go.csv'
order_pathway_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/GO/refine_order_pathway_v4.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
## REAC
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/')
save_name='REAC_heatmap_refined'
heatmap_df_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/heatmap_pathway_top20_go.csv'
order_pathway_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/refine_order_pathway_v2.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
## REAC
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/')
save_name='REAC_heatmap_refined'
heatmap_df_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/heatmap_pathway_top20_reac.csv'
order_pathway_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/refine_order_pathway_v2.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
## KEGG
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/KEGG/')
save_name='KEGG_heatmap_refined'
heatmap_df_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/KEGG/heatmap_pathway_top20_kegg.csv'
order_pathway_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/KEGG/refine_order_pathway_v2.csv'
order_pathway_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/KEGG/refine_order_pathway_v1.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
## KEGG
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/KEGG/')
save_name='KEGG_heatmap_refined'
heatmap_df_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/KEGG/heatmap_pathway_top20_kegg.csv'
order_pathway_file='/Users/manage/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/KEGG/refine_order_pathway_v1.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
gc()
gc()
setwd('/Users/manage/Desktop/Github/PD/pathway/code/')
library(tibble)
# ---- Collect heatmap data for each database----
heatmap_traits='motor,cognition,gds,stai,scopa,ess,rem'
## GO
database='GO'
pathway_result_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genetic/pathway/',database,'/')
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/',database,'/')
if (!dir.exists(heatmap_save_path)) {
dir.create(heatmap_save_path, recursive = TRUE)
}
## GO
database='GO'
pathway_result_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genetic/pathway/',database,'/')
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/',database,'/')
if (!dir.exists(heatmap_save_path)) {
dir.create(heatmap_save_path, recursive = TRUE)
}
cmd=paste('Rscript get_heatmap_table.R',pathway_result_path,heatmap_save_path,heatmap_traits,database)
system(cmd)
## REAC
database='REAC'
pathway_result_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genetic/pathway/',database,'/')
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/',database,'/')
if (!dir.exists(heatmap_save_path)) {
dir.create(heatmap_save_path, recursive = TRUE)
}
cmd=paste('Rscript get_heatmap_table.R',pathway_result_path,heatmap_save_path,heatmap_traits,database)
system(cmd)
## KEGG
database='KEGG'
pathway_result_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genetic/pathway/',database,'/')
heatmap_save_path=paste0('/Users/manage/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/',database,'/')
if (!dir.exists(heatmap_save_path)) {
dir.create(heatmap_save_path, recursive = TRUE)
}
cmd=paste('Rscript get_heatmap_table.R',pathway_result_path,heatmap_save_path,heatmap_traits,database)
system(cmd)
setwd('/Users/manage/Desktop/Github/PD/pathway/code/')
getwd()
# ---- Set Path ----
combine_database='go,reac,kegg'
gpsnet_result_path0='/Users/manage/Desktop/amp_pd_cleaned_results/genetic/GPSnet/GPSnet_result_final/'
gpsnet_result_score_path0='/Users/manage/Desktop/amp_pd_cleaned_results/genetic/GPSnet/GPSnet_result_keep_score_final/'
parent_save_path='/Users/manage/Desktop/amp_pd_cleaned_results/genetic/pathway'
all_traits=c('updrs1','updrs2','updrs3','updrs4','schwab',#motor
'pigd_scores','tremor_scores',
'moca','benton','lns','hvlt','symbol_digit','semantic_fluency',#cognition
'gds', 'stai',#mood
'scopa',#Autonomic
'ess','rem',#sleep
'gco',#global
'total_tau','p_tau181p','alpha_syn','abeta_42',#biomarker
'motor','cognition','mood','sleep'
)
trait_list=paste(all_traits,collapse=',')
gpsnet_result_path=gpsnet_result_path0
gpsnet_result_score_path=gpsnet_result_score_path0
summary_list <- list()
gpsnet_result_suffix='.txt'
version = ''
getwd()
# ----  Plot refined heatmap ----
## GO
heatmap_save_path=paste0('/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/GO/')
save_name='GO_heatmap_refined'
heatmap_df_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/GO/heatmap_pathway_top20_go.csv'
order_pathway_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/GO/refine_order_pathway.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
# ---- Collect heatmap data for each database----
heatmap_traits='motor,cognition,gds,stai,scopa,ess,rem'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
## REAC
heatmap_save_path=paste0('/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/REAC/')
save_name='REAC_heatmap_refined'
heatmap_df_file='/Users/manage/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/REAC/heatmap_pathway_top20_reac.csv'
order_pathway_file='/Users/manage/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/REAC/refine_order_pathway.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
heatmap_df_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/REAC/heatmap_pathway_top20_reac.csv'
order_pathway_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/REAC/refine_order_pathway.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
## KEGG
heatmap_save_path=paste0('/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/KEGG/')
save_name='KEGG_heatmap_refined'
heatmap_df_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/KEGG/heatmap_pathway_top20_kegg.csv'
order_pathway_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/KEGG/refine_order_pathway_v1.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
order_pathway_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/KEGG/refine_order_pathway.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
# ----  Plot refined heatmap ----
## GO
heatmap_save_path=paste0('/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/GO/')
save_name='GO_heatmap_refined'
heatmap_df_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/GO/heatmap_pathway_top20_go.csv'
order_pathway_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/GO/refine_order_pathway.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
## REAC
heatmap_save_path=paste0('/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/')
save_name='REAC_heatmap_refined'
heatmap_df_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/heatmap_pathway_top20_reac.csv'
order_pathway_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/refine_order_pathway.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
## KEGG
heatmap_save_path=paste0('/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/KEGG/')
save_name='KEGG_heatmap_refined'
heatmap_df_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/KEGG/heatmap_pathway_top20_kegg.csv'
order_pathway_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/KEGG/refine_order_pathway.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
## REAC
heatmap_save_path=paste0('/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/')
save_name='REAC_heatmap_refined'
heatmap_df_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/heatmap_pathway_top20_reac.csv'
order_pathway_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/refine_order_pathway.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
## REAC
heatmap_save_path=paste0('/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/')
save_name='REAC_heatmap_refined'
heatmap_df_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/heatmap_pathway_top20_reac.csv'
order_pathway_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/REAC/refine_order_pathway.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
system(cmd)
# ----  Plot refined heatmap ----
## GO
heatmap_save_path=paste0('/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/GO/')
save_name='GO_heatmap_refined'
heatmap_df_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/GO/heatmap_pathway_top20_go.csv'
order_pathway_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genomic/pathway/heatmap/GO/refine_order_pathway.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
# ----  Plot refined heatmap ----
## GO
heatmap_save_path=paste0('/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/GO/')
save_name='GO_heatmap_refined'
heatmap_df_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/GO/heatmap_pathway_top20_go.csv'
order_pathway_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/GO/refine_order_pathway.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
## REAC
heatmap_save_path=paste0('/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/REAC/')
save_name='REAC_heatmap_refined'
heatmap_df_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/REAC/heatmap_pathway_top20_reac.csv'
order_pathway_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/REAC/refine_order_pathway.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
## KEGG
heatmap_save_path=paste0('/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/KEGG/')
save_name='KEGG_heatmap_refined'
heatmap_df_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/KEGG/heatmap_pathway_top20_kegg.csv'
order_pathway_file='/Users/ManqiZhou/Desktop/amp_pd_cleaned_results/genetic/pathway/heatmap/KEGG/refine_order_pathway.csv'
cmd=paste('Rscript plot_refined_heatmap.R',heatmap_df_file,order_pathway_file,heatmap_traits,heatmap_save_path,save_name)
system(cmd)
